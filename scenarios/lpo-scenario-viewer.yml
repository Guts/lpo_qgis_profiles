metadata:
  title: "Demonstration scenario of QGIS Deployment Toolbelt"
  id: qdt-demo-scenario
  description: >-
    Demonstration scenario of QGIS Deployment Toolbelt capabilities.

# Toolbelt settings
settings:
  # LOCAL_WORK_DIR: ~/.cache/qgis-deployment-toolbelt/demo/
  # QGIS_EXE_PATH:
  #   linux: /usr/bin/qgis
  #   mac: /usr/bin/qgis
  #   windows: "%PROGRAMFILES%/QGIS/3_28/bin/qgis-ltr-bin.exe"
  SCENARIO_VALIDATION: true

# Deployment workflow, step by step
steps:
  - name: Download profiles from remote git repository
    uses: qprofiles-downloader
    with:
      source: https://github.com/lpoaura/lpo_qgis_profiles.git
      protocol: git_remote
      branch: main

  - name: Download profiles from remote git repository
    uses: qprofiles-synchronizer
    with:
      sync_mode: overwrite

  - name: Download plugins
    uses: qplugins-downloader
    with:
      force: false
      threads: 3

  - name: Synchronize plugins
    uses: qplugins-synchronizer
    with:
      action: create_or_restore

  - name: Create shortcuts for profiles
    uses: shortcuts-manager
    with:
      action: create_or_restore
      include:
        - profile: QDT Viewer Mode
          label: "QDT - Viewer profile"
          desktop: true
          start_menu: true
        - profile: naturaliste
          label: "Naturaliste"
          desktop: false
          start_menu: false
          icon: "logo_qgis_lpo.ico"
        - profile: mfs
          label: "MFS - Annuaire de comp√©tence"
          desktop: true
          start_menu: true
          icon: "mfs.ico"

  - name: Set splash screen
    uses: splash-screen-manager
    with:
      action: create_or_restore
      strict: false
